# 图片识别功能使用指南

## 🔍 功能概述

智能问答评估系统现已集成OCR（光学字符识别）功能，支持从图片中提取文字内容并自动填入模型回答文本框，大大提升了评估效率。

## ✨ 核心功能

### 1. 图片上传识别
- **位置**：评估中心页面 → 模型回答区域 → "点击或拖拽上传图片"按钮
- **支持格式**：PNG、JPG、JPEG、GIF、BMP
- **文件大小限制**：最大5MB
- **识别语言**：支持中文（简体）和英文混合识别

### 2. 粘贴图片识别
- **使用方法**：在模型回答文本框中直接粘贴（Ctrl+V）图片
- **来源支持**：截图工具、剪贴板图片、复制的图片文件
- **自动处理**：粘贴后立即触发OCR识别

### 3. 实时进度显示
- **进度条**：显示OCR识别进度百分比
- **状态提示**：包含5个阶段的详细提示信息
  - 正在初始化OCR引擎...
  - 正在加载语言模型...
  - 正在预处理图片...
  - 正在识别文字内容...
  - 正在优化识别结果...

### 4. 图片预览功能
- **实时预览**：上传后立即显示图片预览
- **快速清理**：一键清空图片和识别结果
- **状态管理**：OCR处理期间禁用操作按钮

## 🚀 使用流程

### 方式一：按钮上传
1. 在"模型回答"区域点击"点击或拖拽上传图片"按钮
2. 选择要识别的图片文件（PNG/JPG格式，<5MB）
3. 系统自动显示图片预览并开始OCR识别
4. 识别完成后，文字内容自动填入文本框

### 方式二：粘贴上传
1. 复制图片到剪贴板（截图、复制文件等）
2. 在"模型回答"文本框中按 Ctrl+V 粘贴
3. 系统自动检测图片并开始识别流程
4. 识别结果自动追加到文本框现有内容

### 方式三：拖拽上传
1. 直接将图片文件拖拽到上传按钮区域
2. 系统自动处理并开始识别
3. 显示预览和进度，完成后填入文本

## 🎯 最佳实践

### 图片质量建议
- ✅ **高对比度**：黑字白底效果最佳
- ✅ **清晰字体**：避免过小或模糊的字体
- ✅ **正向角度**：确保文字方向正确，避免倾斜
- ✅ **充足光线**：避免阴影和反光

### 文字类型适用性
- ✅ **印刷体文字**：识别准确率最高
- ✅ **屏幕截图**：PDF、网页、文档截图
- ✅ **书籍杂志**：扫描的文字内容
- ⚠️ **手写文字**：准确率较低，建议人工核对

### 内容整理建议
- 📝 识别完成后请检查文字准确性
- 📝 如有错误可手动编辑修正
- 📝 识别结果会追加到现有文本，注意内容整理
- 📝 可使用"清空图片"功能重新识别

## 🔧 技术实现

### 核心技术栈
- **OCR引擎**：Tesseract.js
- **语言支持**：chi_sim（简体中文）+ eng（英文）
- **前端组件**：Ant Design Upload + Image + Progress
- **状态管理**：React Hooks

### 文件结构
```
frontend/src/
├── utils/
│   └── ocrProcessor.js          # OCR处理工具
├── components/
│   └── EvaluationForm.js        # 评估表单（已修改）
```

### 关键功能模块
- `recognizeText()` - 核心OCR识别函数
- `extractImageFromPaste()` - 粘贴事件图片提取
- `handleImageUpload()` - 图片上传处理
- `performOCR()` - OCR执行流程
- `getOCRProgressText()` - 进度文字生成

## 🛠️ 故障排除

### 常见问题

**Q: 识别准确率不高怎么办？**
A: 尝试以下方法：
- 提高图片分辨率和清晰度
- 确保文字方向正确
- 避免复杂背景和装饰字体
- 裁剪图片仅保留文字区域

**Q: 上传图片失败？**
A: 检查以下条件：
- 文件格式是否为PNG/JPG/JPEG
- 文件大小是否超过5MB
- 网络连接是否正常

**Q: OCR识别时间过长？**
A: 可能原因：
- 图片分辨率过高，建议压缩到合适大小
- 网络速度影响（首次加载语言包）
- 图片内容复杂，处理时间较长

**Q: 粘贴功能不起作用？**
A: 确认以下设置：
- 浏览器已允许剪贴板访问权限
- 剪贴板中确实包含图片数据
- 在正确的文本框中执行粘贴操作

## 📈 性能优化

### 已实现优化
- ✅ 图片预览URL自动管理，避免内存泄漏
- ✅ OCR Worker自动销毁，释放资源
- ✅ 进度反馈，提升用户体验
- ✅ 错误处理，优雅降级

### 建议优化
- 📊 对于大量重复识别，可考虑本地缓存结果
- 📊 支持批量图片处理功能
- 📊 集成更多OCR引擎选择

## 🎉 更新日志

### v2.3.6 (2025-12-05)
- ✨ 新增图片OCR识别功能
- ✨ 支持拖拽、粘贴、点击三种上传方式
- ✨ 实时进度显示和状态反馈
- ✨ 中英文混合识别支持
- ✨ 图片预览和管理功能
- 🐛 修复表单清空时的资源清理问题

---

**技术支持**：如遇问题请联系开发团队
**更新说明**：本功能基于Tesseract.js实现，持续优化中 