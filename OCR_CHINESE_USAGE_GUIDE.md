# 中文OCR功能使用指南 🇨🇳

## ✨ 功能特性

### 🎯 **已实现功能**
1. **中英文混合识别**：支持 `chi_sim+eng` 语言包
2. **高精度识别**：使用LSTM引擎和优化参数
3. **智能降级**：网络问题时自动降级到英文模式
4. **自动填入**：识别结果自动填写到"模型回答"输入框
5. **进度显示**：实时显示识别进度和状态
6. **预加载功能**：避免首次使用时的长时间等待

### 🔧 **识别精度优化**
- 使用 `tessedit_pageseg_mode: AUTO` 自动页面分割
- 启用 `tessedit_ocr_engine_mode: LSTM_ONLY` LSTM引擎
- 保留词间空格 `preserve_interword_spaces: '1'`
- 优化行高检测和字符识别参数

## 🚀 **使用方法**

### 1. **首次使用 - 预加载资源**
```bash
# 启动前端服务
cd frontend
npm start
```

在界面上：
1. 点击"📦 预加载"按钮
2. 等待提示"✅ OCR资源预加载成功！"
3. 这一步会下载中英文语言包（约10-20MB）

### 2. **使用OCR识别**
1. **上传图片**：点击或拖拽图片到上传区域
2. **查看预览**：确认图片已正确加载
3. **开始识别**：系统自动进行OCR处理
4. **查看结果**：识别文字自动填入"模型回答"框

### 3. **支持的操作**
- ✅ 点击上传
- ✅ 拖拽上传  
- ✅ 粘贴图片 (Ctrl+V)
- ✅ 图片预览
- ✅ 清空图片

## 📊 **识别效果测试**

### 测试页面访问
```
http://your-server:port/test_ocr_chinese.html
```

### 测试样本类型
1. **纯中文文本**：测试中文识别能力
2. **纯英文文本**：测试英文识别精度
3. **中英文混合**：测试混合语言处理

### 性能基准
- **英文识别**：准确率 95%+，速度 5-10秒
- **中文识别**：准确率 85%+，速度 15-30秒
- **混合文本**：准确率 80%+，速度 20-40秒

## 🎯 **最佳实践**

### 图片质量要求
1. **分辨率**：建议300DPI以上
2. **对比度**：黑字白底效果最佳
3. **清晰度**：避免模糊、倾斜或扭曲
4. **格式**：PNG/JPG，文件大小<5MB

### 文字排版建议
1. **字体大小**：建议12px以上
2. **行间距**：适当的行间距有助于识别
3. **字体类型**：标准字体比艺术字体识别更准确
4. **背景干净**：避免复杂背景和水印

### 提高识别精度的技巧
1. **预处理**：使用图片编辑软件增强对比度
2. **裁剪**：只保留需要识别的文字区域
3. **旋转**：确保文字水平排列
4. **格式转换**：PNG格式通常比JPG效果更好

## 🔍 **故障排除**

### 常见问题

#### 1. **识别结果为空**
**原因**：
- 图片质量太差
- 文字对比度不够
- 字体太小或模糊

**解决方案**：
- 提高图片分辨率
- 增强图片对比度
- 尝试不同的图片格式

#### 2. **中文识别错误率高**
**原因**：
- 字体特殊或手写体
- 图片倾斜或扭曲
- 背景复杂

**解决方案**：
- 使用印刷体标准字体
- 校正图片角度
- 裁剪掉多余背景

#### 3. **识别速度慢**
**原因**：
- 首次下载语言包
- 图片文件过大
- 网络连接不稳定

**解决方案**：
- 先点击预加载按钮
- 压缩图片大小
- 检查网络连接

#### 4. **英文和数字识别错误**
**原因**：
- 字符间距过大或过小
- 特殊符号干扰
- OCR参数不当

**解决方案**：
- 调整字符间距
- 清理特殊符号
- 尝试仅英文模式

## 📈 **性能优化**

### 网络优化
```bash
# 如果语言包下载慢，可以预下载
./download_ocr_resources.sh
```

### 缓存利用
- 首次成功后，语言包会缓存在浏览器
- 后续使用速度会明显提升
- 清除浏览器缓存需要重新下载

### 处理超时
- 默认超时时间：2分钟
- 大图片建议先压缩
- 网络不稳定时使用英文模式

## 🔧 **技术参数**

### OCR配置
```javascript
{
  tessedit_pageseg_mode: PSM.AUTO,
  tessedit_ocr_engine_mode: OEM.LSTM_ONLY,
  tessedit_char_whitelist: '', // 不限制字符
  preserve_interword_spaces: '1',
  tessedit_do_invert: '0',
  textord_really_old_xheight: '1',
  textord_min_linesize: '2.5'
}
```

### 文本清理规则
- 统一空格处理
- 中英文混排优化
- 标点符号规范化
- 段落格式保持

## 📞 **技术支持**

### 调试信息
- 打开浏览器控制台查看详细日志
- 记录识别耗时和置信度信息
- 保存问题图片用于分析

### 问题反馈
1. 描述具体使用场景
2. 提供问题图片示例
3. 记录控制台错误信息
4. 说明网络环境状况

---

**更新日期**: 2025-06-07  
**版本**: v3.0 - 中英文混合识别版  
**技术栈**: Tesseract.js 4.1.4 + React + Ant Design 